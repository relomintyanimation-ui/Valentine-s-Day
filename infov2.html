
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Player Info v2 — Code Specter</title>
    <link rel="icon" type="image/png" href="https://cdn.jsdelivr.net/gh/ShahGCreator/icon@main/PNG/909000001.png">
    <link rel="stylesheet" href="style.css">
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700;800&family=JetBrains+Mono:wght@400;600&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .tab-bar {
            display: flex;
            gap: 8px;
            margin-bottom: 20px
        }

        .tab-btn {
            flex: 1;
            background: rgba(255, 255, 255, .05);
            border: 1px solid rgba(255, 255, 255, .1);
            border-radius: 12px;
            padding: 12px;
            color: var(--text-muted);
            font-weight: 700;
            cursor: pointer;
            transition: all .3s;
            font-family: inherit;
            font-size: .85rem
        }

        .tab-btn.active {
            background: linear-gradient(135deg, rgba(108, 92, 231, .3), rgba(0, 206, 201, .15));
            border-color: var(--primary);
            color: #fff;
            box-shadow: 0 0 20px var(--primary-glow)
        }

        .tab-content {
            display: none;
            animation: fadeIn .4s ease
        }

        .tab-content.active {
            display: block
        }

        .result-card {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, .08);
            border-radius: 18px;
            padding: 24px;
            margin-top: 20px;
            display: none;
            animation: fadeIn .4s ease
        }

        .result-card.show {
            display: block
        }

        .section-title {
            font-size: .8rem;
            font-weight: 700;
            letter-spacing: 1.5px;
            text-transform: uppercase;
            color: var(--secondary);
            margin: 18px 0 10px;
            padding-top: 12px;
            border-top: 1px solid rgba(255, 255, 255, .06)
        }

        .section-title:first-child {
            margin-top: 0;
            border: none;
            padding-top: 0
        }

        .result-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, .04)
        }

        .result-row:last-child {
            border: none
        }

        .result-key {
            color: var(--text-muted);
            font-size: .85rem
        }

        .result-val {
            font-weight: 700;
            font-size: .85rem;
            text-align: right;
            max-width: 60%;
            word-break: break-all
        }

        .json-output {
            font-family: 'JetBrains Mono', monospace;
            font-size: .8rem;
            line-height: 1.6;
            white-space: pre-wrap;
            word-break: break-all;
            color: var(--text);
            max-height: 400px;
            overflow-y: auto;
            padding: 15px;
            background: rgba(0, 0, 0, .3);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, .05)
        }

        select {
            width: 100%;
            background: rgba(0, 0, 0, .4);
            border: 1px solid rgba(255, 255, 255, .12);
            border-radius: 12px;
            color: var(--text);
            padding: 14px;
            font-family: inherit;
            font-size: .9rem;
            cursor: pointer;
            appearance: none;
            -webkit-appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23b2bec3' d='M6 8L1 3h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 14px center
        }

        select:focus {
            border-color: var(--secondary);
            box-shadow: 0 0 0 3px rgba(0, 206, 201, .15)
        }

        .search-result-item {
            background: rgba(255, 255, 255, .03);
            border: 1px solid rgba(255, 255, 255, .06);
            border-radius: 12px;
            padding: 14px;
            margin-bottom: 10px
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px)
            }

            to {
                opacity: 1;
                transform: translateY(0)
            }
        }
    </style>
</head>

<body>
    <div class="background-globes">
        <div class="globe globe-1"></div>
        <div class="globe globe-2"></div>
        <div class="globe globe-3"></div>
    </div>
    <div class="app-container">
        <header>
            <a class="logo" href="/">
                <div class="logo-icon"><i class="fa-solid fa-bolt" style="color:#fff;"></i></div>
                <div class="logo-text"><strong>Code Specter</strong><span>FREE FIRE HACKS</span></div>
            </a>
            <div style="display:flex;align-items:center;gap:15px;">
                <a href="/" class="header-badge"
                    style="text-decoration:none;background:rgba(108,92,231,.15);border-color:var(--primary);color:#a29bfe;">
                    <i class="fa-solid fa-house" style="font-size:.7rem;"></i> Home
                </a>
                <div class="header-badge">
                    <div class="dot"></div>Online
                </div>
            </div>
        </header>

        <h2><i class="fa-solid fa-chart-line" style="color:#a29bfe;margin-right:10px;"></i>Player Info v2</h2>

        <div class="tab-bar">
            <button class="tab-btn active" onclick="switchTab('player')"><i class="fa-solid fa-user"></i>
                Player</button>
            <button class="tab-btn" onclick="switchTab('stats')"><i class="fa-solid fa-chart-bar"></i> Stats</button>
            <button class="tab-btn" onclick="switchTab('search')"><i class="fa-solid fa-magnifying-glass"></i>
                Search</button>
        </div>

        <!-- Player Tab -->
        <div class="tab-content active" id="tab-player">
            <div class="form-group">
                <label>Player UID</label>
                <input type="number" id="v2p-uid" placeholder="Enter Free Fire UID">
            </div>
            <div class="form-group">
                <label>Server</label>
                <div class="select-group">
                    <button class="region-btn" onclick="selSrv(this,'ind','v2p')" data-value="ind">IND</button>
                    <button class="region-btn" onclick="selSrv(this,'bd','v2p')" data-value="bd">BD</button>
                    <button class="region-btn" onclick="selSrv(this,'sg','v2p')" data-value="sg">SG</button>
                    <button class="region-btn" onclick="selSrv(this,'br','v2p')" data-value="br">BR</button>
                    <button class="region-btn" onclick="selSrv(this,'na','v2p')" data-value="na">NA</button>
                    <button class="region-btn" onclick="selSrv(this,'us','v2p')" data-value="us">US</button>
                    <button class="region-btn" onclick="selSrv(this,'pk','v2p')" data-value="pk">PK</button>
                    <button class="region-btn" onclick="selSrv(this,'mea','v2p')" data-value="mea">MEA</button>
                    <button class="region-btn" onclick="selSrv(this,'europe','v2p')" data-value="europe">EU</button>
                </div>
            </div>
            <button class="action-btn" id="v2p-btn" onclick="doV2Player()">
                Get Player Data <i class="fa-solid fa-magnifying-glass"></i>
            </button>
            <div class="status-bar" id="v2p-status">
                <div class="spinner"></div>
                <div class="status-dot"></div>
                <span class="status-text">Ready to get player data</span>
            </div>
            <div class="result-card" id="v2p-result"></div>
        </div>

        <!-- Stats Tab -->
        <div class="tab-content" id="tab-stats">
            <div class="form-group">
                <label>Player UID</label>
                <input type="number" id="v2s-uid" placeholder="Enter Free Fire UID">
            </div>
            <div class="form-group">
                <label>Server</label>
                <div class="select-group">
                    <button class="region-btn" onclick="selSrv(this,'ind','v2s')" data-value="ind">IND</button>
                    <button class="region-btn" onclick="selSrv(this,'bd','v2s')" data-value="bd">BD</button>
                    <button class="region-btn" onclick="selSrv(this,'sg','v2s')" data-value="sg">SG</button>
                    <button class="region-btn" onclick="selSrv(this,'br','v2s')" data-value="br">BR</button>
                    <button class="region-btn" onclick="selSrv(this,'na','v2s')" data-value="na">NA</button>
                    <button class="region-btn" onclick="selSrv(this,'us','v2s')" data-value="us">US</button>
                    <button class="region-btn" onclick="selSrv(this,'pk','v2s')" data-value="pk">PK</button>
                    <button class="region-btn" onclick="selSrv(this,'mea','v2s')" data-value="mea">MEA</button>
                    <button class="region-btn" onclick="selSrv(this,'europe','v2s')" data-value="europe">EU</button>
                </div>
            </div>
            <div class="form-group">
                <label>Game Mode</label>
                <select id="v2s-gamemode">
                    <option value="br">Battle Royale</option>
                    <option value="cs">Clash Squad</option>
                </select>
            </div>
            <div class="form-group">
                <label>Match Mode</label>
                <select id="v2s-matchmode">
                    <option value="RANKED">Ranked</option>
                    <option value="NORMAL">Normal</option>
                    <option value="CAREER">Career</option>
                </select>
            </div>
            <button class="action-btn" id="v2s-btn" onclick="doV2Stats()">
                Get Stats <i class="fa-solid fa-chart-bar"></i>
            </button>
            <div class="status-bar" id="v2s-status">
                <div class="spinner"></div>
                <div class="status-dot"></div>
                <span class="status-text">Ready to get stats</span>
            </div>
            <div class="result-card" id="v2s-result"></div>
        </div>

        <!-- Search Tab -->
        <div class="tab-content" id="tab-search">
            <div class="form-group">
                <label>Player Name (min 3 chars)</label>
                <input type="text" id="v2k-keyword" placeholder="Search player name...">
            </div>
            <div class="form-group">
                <label>Server</label>
                <div class="select-group">
                    <button class="region-btn" onclick="selSrv(this,'ind','v2k')" data-value="ind">IND</button>
                    <button class="region-btn" onclick="selSrv(this,'bd','v2k')" data-value="bd">BD</button>
                    <button class="region-btn" onclick="selSrv(this,'sg','v2k')" data-value="sg">SG</button>
                    <button class="region-btn" onclick="selSrv(this,'br','v2k')" data-value="br">BR</button>
                    <button class="region-btn" onclick="selSrv(this,'na','v2k')" data-value="na">NA</button>
                    <button class="region-btn" onclick="selSrv(this,'us','v2k')" data-value="us">US</button>
                    <button class="region-btn" onclick="selSrv(this,'pk','v2k')" data-value="pk">PK</button>
                    <button class="region-btn" onclick="selSrv(this,'mea','v2k')" data-value="mea">MEA</button>
                    <button class="region-btn" onclick="selSrv(this,'europe','v2k')" data-value="europe">EU</button>
                </div>
            </div>
            <button class="action-btn" id="v2k-btn" onclick="doV2Search()">
                Search <i class="fa-solid fa-magnifying-glass"></i>
            </button>
            <div class="status-bar" id="v2k-status">
                <div class="spinner"></div>
                <div class="status-dot"></div>
                <span class="status-text">Ready to search</span>
            </div>
            <div class="result-card" id="v2k-result"></div>
        </div>

        <footer>
            <p>&copy; 2026 All rights reserved <a href="https://www.codespecters.com/" target="_blank"
                    class="footer-link">CODE SPECTER</a></p>
        </footer>
    </div>
    <div id="notification-area"></div>
    <script src="config.js"></script>
    <script>
        const servers = { v2p: "ind", v2s: "ind", v2k: "ind" };

        function selSrv(btn, val, prefix) {
            btn.closest(".select-group").querySelectorAll(".region-btn").forEach(b => b.classList.remove("active"));
            btn.classList.add("active");
            servers[prefix] = val;
        }

        function switchTab(tab) {
            document.querySelectorAll(".tab-btn").forEach((b, i) => {
                const tabs = ["player", "stats", "search"];
                b.classList.toggle("active", tabs[i] === tab);
            });
            ["tab-player", "tab-stats", "tab-search"].forEach(id => {
                document.getElementById(id).classList.toggle("active", id === "tab-" + tab);
            });
        }

        function setStatus(id, msg, type = 'loading') {
            const bar = document.getElementById(id);
            if (!bar) return;
            bar.className = `status-bar active ${type}`;
            bar.querySelector('.status-text').textContent = msg;
            const spinner = bar.querySelector('.spinner');
            if (spinner) spinner.style.display = (type === 'loading') ? 'block' : 'none';
        }

        function row(k, v) { return `<div class="result-row"><span class="result-key">${k}</span><span class="result-val">${v ?? "—"}</span></div>`; }
        function sec(t) { return `<div class="section-title">${t}</div>`; }

        async function doV2Player() {
            const uid = document.getElementById("v2p-uid").value.trim();
            if (!uid) {
                showNotification("Please enter a Player UID", "error");
                document.getElementById("v2p-uid").focus();
                return;
            }
            if (!servers.v2p) {
                showNotification("Please select a Server first", "error");
                return;
            }
            const btn = document.getElementById("v2p-btn");
            const result = document.getElementById("v2p-result");
            btn.classList.add("loading"); btn.disabled = true;
            setStatus("v2p-status", "Accessing encrypted game data...", "loading");
            result.className = "result-card"; result.innerHTML = "";
            try {
                const resp = await fetch(`${API_BASE}/infov2/player?uid=${uid}&server=${servers.v2p}&key=${API_KEY}`);
                if (!resp.ok) {
                    const err = await resp.json();
                    throw new Error(err.detail?.message || "FF server did not return player data.");
                }
                const d = await resp.json();

                let html = "";
                const bi = d.basicinfo || {};
                const si = d.socialinfo || {};
                const cb = d.clanbasicinfo || {};
                const cap = d.captainbasicinfo || {};
                const pet = d.petinfo || {};
                const cs = d.creditscoreinfo || {};

                function fmtDate(ts) {
                    if (!ts || ts === "0" || ts === 0) return "—";
                    return new Date(parseInt(ts) * 1000).toLocaleString();
                }

                html += sec("Essential Info");
                html += row("Nickname", bi.nickname);
                html += row("Account ID", bi.accountid || uid);
                html += row("Level", bi.level);
                html += row("Region", bi.region);
                html += row("Likes", bi.liked);
                html += row("Exp", bi.exp);
                html += row("Created At", fmtDate(bi.createat));
                html += row("Last Login", fmtDate(bi.lastloginat));
                html += row("Season ID", bi.seasonid);
                html += row("Release Version", bi.releaseversion);

                html += sec("Battle Stats");
                html += row("BR Rank Points", bi.rankingpoints);
                html += row("BR Rank", bi.rank);
                html += row("CS Rank Points", bi.csrankingpoints);
                html += row("CS Rank", bi.csrank);
                html += row("Max Rank", bi.maxrank);
                html += row("CS Max Rank", bi.csmaxrank);
                html += row("Badge Count", bi.badgecnt);

                if (cb && cb.clanname) {
                    html += sec("Guild Details");
                    html += row("Guild Name", cb.clanname);
                    html += row("Guild ID", cb.clanid);
                    html += row("Guild Level", cb.clanlevel);
                    html += row("Capacity", `${cb.membernum}/${cb.capacity}`);

                    if (cap && cap.nickname) {
                        html += sec("Guild Captain");
                        html += row("Captain Name", cap.nickname);
                        html += row("Captain UID", cap.accountid);
                        html += row("Captain Level", cap.level);
                        html += row("Captain Rank", cap.rank);
                    }
                }

                if (pet && pet.name) {
                    html += sec("Pet Info");
                    html += row("Pet Name", pet.name);
                    html += row("Pet Level", pet.level);
                    html += row("Pet Exp", pet.exp);
                }

                if (si && si.signature) {
                    html += sec("Social Info");
                    html += row("Gender", si.gender?.replace("GENDER", ""));
                    html += row("Language", si.language?.replace("LANGUAGE", ""));
                    html += row("Time Active", si.timeactive?.replace("TIMEACTIVE", ""));
                    html += row("Signature", si.signature);
                }

                if (cs && cs.creditscore) {
                    html += sec("Credit Score");
                    html += row("Score", cs.creditscore);
                    html += row("Reward State", cs.rewardstate);
                }

                if (!html) html = `<div class="json-output">${escHtml(JSON.stringify(d, null, 2))}</div>`;

                result.innerHTML = html;
                result.className = "result-card show";
                setStatus("v2p-status", "Player details parsed successfully.", "success");
                showNotification("Player data loaded!", "success");
            } catch (e) {
                setStatus("v2p-status", "Error: " + e.message, "error");
                showNotification(e.message || "Failed to load player data", "error");
            }
            finally {
                btn.classList.remove("loading"); btn.disabled = false;
                const bar = document.getElementById("v2p-status");
                if (bar.classList.contains("loading")) setStatus("v2p-status", "Ready to get player data", "info");
            }
        }

        const statLabels = {
            kills_count: "Total Kills",
            win_count: "Total Wins",
            match_count: "Matches Played",
            gamesplayed: "Games Played",
            wins: "Wins",
            kills: "Kills",
            rank: "Rank Points",
            ranking_points: "Rank Points",
            max_rank: "Season Max Rank",
            is_new: "New Entry",
            kill_death_ratio: "K/D Ratio",
            win_rate: "Win Rate",
            average_damage: "Avg Damage",
            mvp_count: "MVP Count",
            deaths: "Deaths",
            topntimes: "Top N Times",
            distancetravelled: "Distance Travelled",
            survivaltime: "Survival Time",
            revives: "Revives",
            highestkills: "Highest Kills",
            damage: "Total Damage",
            headshots: "Headshots",
            headshotkills: "Headshot Kills",
            knockdown: "Knockdowns",
            pickups: "Pickups",
            accountid: "Account ID",
            solostats: "Solo Stats",
            duostats: "Duo Stats",
            quadstats: "Quad Stats",
            detailedstats: "Detailed Stats"
        };

        function formatStatKey(k) {
            if (statLabels[k]) return statLabels[k];
            // Handle camelCase and lowercase with spaces
            return k.replace(/([A-Z])/g, ' $1').replace(/^./, str => str.toUpperCase()).trim();
        }

        async function doV2Stats() {
            const uid = document.getElementById("v2s-uid").value.trim();
            if (!uid) {
                showNotification("Please enter a Player UID", "error");
                document.getElementById("v2s-uid").focus();
                return;
            }
            if (!servers.v2s) {
                showNotification("Please select a Server first", "error");
                return;
            }
            const gamemode = document.getElementById("v2s-gamemode").value;
            const matchmode = document.getElementById("v2s-matchmode").value;
            const btn = document.getElementById("v2s-btn");
            const result = document.getElementById("v2s-result");
            btn.classList.add("loading"); btn.disabled = true;
            setStatus("v2s-status", `Pulling ${gamemode.toUpperCase()} ${matchmode} stats...`, "loading");
            result.className = "result-card"; result.innerHTML = "";
            try {
                const resp = await fetch(`${API_BASE}/infov2/stats?uid=${uid}&server=${servers.v2s}&gamemode=${gamemode}&matchmode=${matchmode}&key=${API_KEY}`);
                if (!resp.ok) {
                    const err = await resp.json();
                    throw new Error(err.detail?.message || "Stats not found for this mode.");
                }
                const d = await resp.json();
                let html = sec(`${gamemode.toUpperCase()} ${matchmode} Statistics`);

                const stats = d.data || d.stats || d;

                function renderStats(obj, title = "") {
                    let sectionHtml = "";
                    let rowsHtml = "";

                    for (const [k, v] of Object.entries(obj)) {
                        if (["credits", "metadata", "success"].includes(k)) continue;

                        if (typeof v === "object" && v !== null && !Array.isArray(v)) {
                            // Only render if the object has contents
                            if (Object.keys(v).length > 0) {
                                sectionHtml += rowsHtml;
                                rowsHtml = "";
                                sectionHtml += renderStats(v, formatStatKey(k));
                            }
                        } else if (!Array.isArray(v) && v !== null && v !== undefined) {
                            rowsHtml += row(formatStatKey(k), v);
                        }
                    }

                    if (rowsHtml === "" && sectionHtml === "") return "";
                    return (title ? sec(title) : "") + sectionHtml + rowsHtml;
                }

                if (stats && typeof stats === "object") {
                    html += renderStats(stats);
                } else {
                    html += `<div class="json-output">${escHtml(JSON.stringify(d, null, 2))}</div>`;
                }
                result.innerHTML = html;
                result.className = "result-card show";
                setStatus("v2s-status", "Statistics calculated and displayed.", "success");
                showNotification("Stats loaded!", "success");
            } catch (e) {
                setStatus("v2s-status", "Error: " + e.message, "error");
                showNotification(e.message || "Failed to load stats", "error");
            }
            finally {
                btn.classList.remove("loading"); btn.disabled = false;
                const bar = document.getElementById("v2s-status");
                if (bar.classList.contains("loading")) setStatus("v2s-status", "Ready to get stats", "info");
            }
        }

        async function doV2Search() {
            const keyword = document.getElementById("v2k-keyword").value.trim();
            if (!keyword) {
                showNotification("Please enter a Search Keyword", "error");
                document.getElementById("v2k-keyword").focus();
                return;
            }
            if (keyword.length < 3) {
                showNotification("Keyword must be at least 3 characters", "error");
                document.getElementById("v2k-keyword").focus();
                return;
            }
            if (!servers.v2k) {
                showNotification("Please select a Server first", "error");
                return;
            }
            const btn = document.getElementById("v2k-btn");
            const result = document.getElementById("v2k-result");
            btn.classList.add("loading"); btn.disabled = true;
            setStatus("v2k-status", "Scanning global database for matches...", "loading");
            result.className = "result-card"; result.innerHTML = "";
            try {
                const resp = await fetch(`${API_BASE}/infov2/search?keyword=${encodeURIComponent(keyword)}&server=${servers.v2k}&key=${API_KEY}`);
                if (!resp.ok) {
                    const err = await resp.json();
                    throw new Error(err.detail?.message || "Search service unavailable.");
                }
                const d = await resp.json();
                let html = sec("Search Results");
                let accounts = d.accounts || d.infos || d.fuzzy_search_account_by_name || d.fuzzySearchAccountByName || [];
                if (!Array.isArray(accounts)) {
                    for (const key in d) {
                        if (Array.isArray(d[key])) { accounts = d[key]; break; }
                    }
                }
                if (Array.isArray(accounts)) {
                    if (accounts.length === 0) html += `<div style="color:var(--text-muted);padding:10px 0;">No players found with this name in this region.</div>`;
                    accounts.forEach((acc, i) => {
                        const abi = acc.basic_info || acc.basicInfo || acc;
                        html += `<div class="search-result-item">`;
                        html += row("#" + (i + 1), acc.nickname || abi.nickname || "—");
                        if (acc.accountid || acc.account_id || acc.accountId || abi.accountId || abi.account_id) html += row("UID", acc.accountid || acc.account_id || acc.accountId || abi.accountId || abi.account_id);
                        if (acc.level || abi.level) html += row("Level", acc.level || abi.level);
                        if (acc.region || abi.region) html += row("Region", acc.region || abi.region);
                        html += `</div>`;
                    });
                } else {
                    html += `<div class="json-output">${escHtml(JSON.stringify(d, null, 2))}</div>`;
                }
                result.innerHTML = html;
                result.className = "result-card show";
                setStatus("v2k-status", `Found ${accounts.length} potential matches.`, "success");
                showNotification(`Found ${accounts.length} players`, "success");
            } catch (e) {
                setStatus("v2k-status", "Error: " + e.message, "error");
                showNotification(e.message || "Search failed", "error");
            }
            finally {
                btn.classList.remove("loading"); btn.disabled = false;
                const bar = document.getElementById("v2k-status");
                if (bar.classList.contains("loading")) setStatus("v2k-status", "Ready to search", "info");
            }
        }

        document.getElementById("v2p-uid").addEventListener("keydown", e => { if (e.key === "Enter") doV2Player(); });
        document.getElementById("v2s-uid").addEventListener("keydown", e => { if (e.key === "Enter") doV2Stats(); });
        document.getElementById("v2k-keyword").addEventListener("keydown", e => { if (e.key === "Enter") doV2Search(); });

        function escHtml(s) { return s.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;"); }

        function showNotification(msg, type = "info") {
            const area = document.getElementById("notification-area");
            const n = document.createElement("div"); n.className = `notification ${type}`; n.textContent = msg;
            area.appendChild(n); setTimeout(() => { n.style.opacity = "0"; setTimeout(() => n.remove(), 400); }, 3000);
        }
    </script>
</body>

</html>